# 数据链路控制

> 原文:[https://www.javatpoint.com/data-link-controls](https://www.javatpoint.com/data-link-controls)

数据链路控制是由数据链路层提供的服务，用于在物理介质上提供可靠的数据传输。例如，在半双工传输模式下，一台设备一次只能传输数据。如果链路末端的两个设备同时传输数据，它们会发生冲突，导致信息丢失。数据链路层提供设备间的协调，因此不会发生冲突。

**数据链路层提供三个功能:**

*   行业纪律
*   流控制
*   错误控制

![Data Link Controls](../Images/c54aa753aeacc2ac5b872afdf94b5f55.png)

## 生产线规程

*   线路规程是数据链路层的一项功能，它提供链路系统之间的协调。它决定了哪个设备可以发送，以及何时可以发送数据。

**线路纪律可以通过两种方式实现:**

*   ENQ/ACK
*   投票/选择

**结束/确认**

END/ACK 代表询问/确认，用于当链路上没有错误的接收器，并且两个设备之间有专用路径，以便能够接收传输的设备是预期的设备时。

结束/确认协调哪个设备将开始传输，以及接收方是否准备好。

**结束/确认工作**

发送器发送被称为询问(ENQ)的帧，询问接收器是否可以接收数据。

接收器以肯定确认(确认)或否定确认(NACK)进行响应，其中肯定确认表示接收器已准备好接收传输，否定确认表示接收器无法接受传输。

**以下是接收器的响应:**

*   如果对 ENQ 的响应是肯定的，发送方将发送它的数据，并且一旦它的所有数据都被发送，设备就以一个 EOT(传输结束)帧结束它的传输。
*   如果对 ENQ 的响应是否定的，则发送方断开连接，并在另一时间重新开始传输。
*   如果响应既不是否定的也不是肯定的，则发送方假设 ENQ 帧在传输期间丢失，并在放弃之前尝试三次建立链接。

![Data Link Controls](../Images/a88b576a94854f6116a52226905912ee.png)

**投票/选择**

线路规程的轮询/选择方法适用于这样的拓扑，其中一个设备被指定为主站，而其他设备是次站。

**投票/选择工作**

*   在这种情况下，主设备和多个辅助设备由一条传输线组成，所有交换都通过主设备进行，即使目的地是辅助设备。
*   主设备控制通信链路，辅助设备遵循主设备的指令。
*   主设备确定哪个设备被允许使用通信信道。因此，我们可以说它是会议的发起者。
*   如果主设备想要从辅助设备接收数据，它会要求辅助设备发送任何东西，这个过程称为轮询。
*   如果主设备想要向辅助设备发送一些数据，那么它会告诉目标辅助设备准备接收数据，这个过程称为选择。

**选择**

*   当主设备有东西要发送时，使用选择模式。
*   当主设备想要发送一些数据时，它通过发送选择(SEL)帧来提醒辅助设备即将进行的传输，该帧的一个字段包括预期辅助设备的地址。
*   当辅助设备收到 SEL 帧时，它会发送一个确认，指示辅助设备就绪状态。
*   如果辅助设备已准备好接受数据，则主设备会向目标辅助设备发送两个或更多数据帧。一旦数据被发送，次级发送一个确认，指定数据已经被接收。

![Data Link Controls](../Images/49275dfaff1f84142aacdc4cbd7bf98d.png)

**投票**

*   当主设备想要从辅助设备接收一些数据时，使用轮询模式。
*   当主设备想要接收数据时，它会询问每个设备是否有要发送的内容。
*   首先，主设备询问(轮询)第一个辅助设备，如果它以 NACK 响应(否定确认)表示它没有什么要发送的。现在，它接近第二个辅助设备，用确认进行响应，这意味着它有数据要发送。辅助设备可以一个接一个地发送多个帧，或者有时可能需要在发送每个帧之前发送确认，具体取决于所使用的协议类型。

![Data Link Controls](../Images/8fe6f8948a623ffc780e2f68a46a84d3.png)

## 流控制

*   它是一套程序，告诉发送方在数据淹没接收方之前可以传输多少数据。
*   接收设备存储数据的速度和内存有限。因此，接收设备必须能够在达到限制之前通知发送设备暂时停止传输。
*   它需要一个缓冲区，一个存储信息直到信息被处理的内存块。

**已经开发了两种控制数据流的方法:**

*   停下来等待
*   推拉窗

**停车等待**

*   在停止等待方法中，发送方在发送的每一帧后等待确认。
*   收到确认后，只发送下一帧。交替发送和等待帧的过程一直持续到发送方发送 EOT(传输结束)帧。

**停车等待的优势**

停止等待方法很简单，因为在发送下一帧之前，会检查并确认每一帧。

**停止等待**的缺点

停止等待技术的使用效率很低，因为每一帧都必须一路传送到接收器，并且在发送下一帧之前一路传送确认。发送和接收的每一帧都使用了穿越链路所需的全部时间。

**推拉窗**

*   滑动窗口是一种流量控制方法，在这种方法中，发送方可以在获得确认之前传输几个帧。
*   在滑动窗口控制中，由于可以有效地利用通信信道的容量，可以一个接一个地发送多个帧。
*   单个确认确认多个帧。
*   滑动窗口是指发送端和接收端的假想方框。
*   该窗口可以在任一端保存帧，并且它提供了在确认之前可以传输的帧数的上限。
*   即使窗口没有完全填满，也可以确认帧。
*   窗口有一个特定的大小，其中它们被编号为模 n 意味着它们被编号从 0 到 n-1。例如，如果 n = 8，则帧从 0，1，2，3，4，5，6，7，0，1，2，3，4，5，6，7，0，1 开始编号........
*   窗口的大小表示为 n-1。因此，在确认之前最多可以发送 n-1 帧。
*   当接收方发送确认时，它包括它想要接收的下一帧的编号。例如，为了确认以帧号 4 结束的帧串，接收器将发送包含帧号 5 的确认。当发送方看到带有数字 5 的确认时，它知道从 0 到 4 的帧已经被接收。

**发送方窗口**

*   在传输开始时，发送器窗口包含 n-1 帧，当它们被发送出去时，左边界向内移动，缩小了窗口的大小。例如，如果发送三帧时窗口大小为 w，则发送方窗口中剩余的帧数为 w-3。
*   一旦确认到达，发送方窗口将扩展到与确认确认的帧数相等的数量。
*   例如，窗口的大小是 7，如果帧 0 到 4 已经被发送出去并且没有确认到达，那么发送者窗口只包含两个帧，即 5 和 6。现在，如果 ACK 到达时带有数字 4，这意味着 0 到 3 帧未损坏地到达，并且发送器窗口被扩展以包括接下来的四帧。因此，发送方窗口包含六个帧(5，6，7，0，1，2)。

![Data Link Controls](../Images/cdd2d8d2fd3bc47bafc844db654514b0.png)

**接收器窗口**

*   传输开始时，接收器窗口不包含 n 帧，但包含 n-1 个帧空间。
*   当新帧到达时，窗口的大小会缩小。
*   接收器窗口不代表接收的帧数，但它代表在发送确认之前可以接收的帧数。例如，窗口的大小为 w，如果接收到三帧，则窗口中可用的空间数量为(w-3)。
*   发送确认后，接收器窗口会扩大，其数量等于确认的帧数。
*   假设窗口的大小为 7，这意味着接收器窗口包含 7 个空间，用于 7 帧。如果接收到一帧，则接收器窗口缩小并将边界从 0 移动到 1。这样，窗口一个接一个地缩小，所以窗口现在包含了六个空格。如果从 0 到 4 的帧已经发送，那么在发送确认之前，窗口包含两个空格。

![Data Link Controls](../Images/6221181af6f8174cd7fa55c9fe307e33.png)

## 错误控制

错误控制是一种错误检测和重传技术。

**差错控制类别:**

![Data Link Controls](../Images/bd0e5d9d0109048a638d21dce830174a.png)

**停车等待 ARQ**

停止等待 ARQ 是一种用于在帧损坏或丢失的情况下重新传输数据的技术。

这种技术的工作原理是，发送方在收到对最后一个发送帧的确认之前，不会发送下一个帧。

**重传需要四个特征:**

*   发送设备保留最后发送的帧的副本，直到收到确认。如果帧没有被正确接收，保留副本允许发送方重新发送数据。
*   数据帧和确认帧交替编号为 0 和 1，以便可以单独识别。假设数据 1 帧确认数据 0 帧意味着数据 0 帧已经正确到达，并期望接收数据 1 帧。
*   如果在最后发送的帧中出现错误，则接收器发送未编号的 NAK 帧。接收到 NAK 帧后，发送方会重新传输数据。
*   它和计时器一起工作。如果在分配的时间内没有收到确认，则发送方会认为帧在传输过程中丢失，因此会重新发送帧。

**重传的两种可能性:**

*   **损坏帧:**当接收机收到损坏帧，即该帧包含错误时，则返回 NAK 帧。例如，当数据 0 帧被发送，然后接收器发送 ACK 1 帧意味着数据 0 已经正确到达，并且发送数据 1 帧。发送方发送下一帧:数据 1。它完好无损地到达，接收器返回确认 0。发送方传输下一帧:数据 0。接收器报告错误并返回 NAK 帧。发送方重新发送数据 0 帧。
*   **丢帧:**发送方配有定时器，发送帧时开始计时。有时帧还没有到达接收端，因此它既不能被肯定地也不能被否定地确认。发送方等待确认，直到定时器关闭。如果计时器关闭，它会重新传输最后一个传输的帧。

**推拉窗 ARQ**

滑动窗口 ARQ 是一种用于连续传输误差控制的技术。

**用于重传的三个特征:**

*   在这种情况下，发送方保留所有传输帧的副本，直到它们被确认。假设从 0 到 4 的帧已经传输，最后一次确认是帧 2，发送方必须保留帧 3 和 4 的副本，直到它们正确接收。
*   接收机可以根据条件发送否定应答或确认应答。NAK 帧告诉发送方数据已被接收到并已损坏。由于滑动窗口是一种连续传输机制，确认和否定都必须编号，以识别帧。确认帧由一个数字组成，该数字代表接收器预期接收的下一帧。NAK 帧由代表损坏帧的数字组成。
*   滑动窗口 ARQ 配备了定时器来处理丢失的确认。假设在收到任何确认之前已经发送了 n-1 帧。发送方等待确认，因此它启动计时器并在发送之前等待。如果分配的时间用完，发送方将根据使用的协议重新发送一个或所有帧。

**滑动窗口 ARQ 中使用的两个协议:**

*   **回退-n ARQ:** 在回退-n ARQ 协议中，如果一帧丢失或损坏，则它会重新传输所有帧，之后它不会收到肯定的 ack。

重传有三种可能:

*   **损坏帧:**当帧损坏时，接收机发送一个 NAK 帧。

![Data Link Controls](../Images/f00887e290f0ed25efe053aad0f85ee0.png)

在上图中，在第三帧中发现错误之前，已经传输了三帧。在这种情况下，已返回 ACK 2，告知帧 0、1 已被成功接收，没有任何错误。接收器发现数据 2 帧中的错误，因此返回 NAK 2 帧。帧 3 也被丢弃，因为它是在损坏的帧之后传输的。因此，发送方重新发送帧 2、3。

*   **丢失数据帧:**在滑动窗口协议中，数据帧按顺序发送。如果任何一帧丢失，那么到达接收器的下一帧就是无序的。接收器检查每个帧的序列号，发现被跳过的帧，并返回丢失帧的 NAK。发送设备重新发送由 NAK 指示的帧以及在丢失帧之后发送的帧。
*   **丢失确认:**在等待任何确认之前，发送方可以发送窗口允许的尽可能多的帧。一旦达到窗口的限制，发送方就没有帧可发送；它必须等待确认。如果确认丢失，那么发送者可能会永远等待。为了避免这种情况，发送方配备了计时器，只要达到窗口容量，计时器就会开始计数。如果在时限内没有收到确认，则发送方会重新发送自上次确认后的帧。

**选择性-拒绝 ARQ**

*   选择性拒绝 ARQ 技术比回退 ARQ 更有效。
*   在这种技术中，只有收到否定确认(NAK)的帧才会被重发。
*   接收器存储缓冲区会保留所有损坏的帧，直到错误帧被正确接收。
*   接收器必须具有适当的逻辑，以正确的顺序重新插入帧。
*   发送方必须包含一个搜索机制，只选择请求的帧进行重传。

![Data Link Controls](../Images/aaba8f63ada7fbee0f58f538e4cd4163.png)